# Ch13 대리자와 이벤트
## 대리자
콜백(Callback)은 어떤 일을 수행하는 코드이다. 콜백을 작성하고 다른 코드에 이 콜백을 맡겨 대신 실행하는데 사용한다.<br/>
C#에서는 대리자(Delegate)가 콜백을 맡아 실행하는 일을 한다.<br/>

	한정자 delegate 반환_형식 대리자_이름 ( 매개변수_목록 );

형식으로 사용할 수 있다.반환 형식과 매개변수 목록은 자신이 참조할 메소드와 같아야 한다.<br/>

대리자는 다음 순서로 작동한다.<br/>
  1. 대리자를 선언한다.
  2. 대리자의 인스턴스를 생성한다.
  3. 대리자가 참조할 메소드를 인수로 넘긴다.
  4. 대리자를 호출한다.

그러면 대리자 안의 메소드들이 실행된다.<br/>

대리자는 값이 아닌 코드 자체를 매개변수에 넘기고 싶을 때 유용하다.<br/>
정렬로 예를 들면 내림차순, 오름차순과 같이 정렬 기준인 비교 방법을 전달하고 싶을 때 대리자를 사용할 수 있다.<br/>


대리자는 메소드뿐 아니라 일반화 메소드도 참조할 수 있다.<br/>
이 경우 대리자도 일반화 메소드를 참조할 수 있또록 형식 매개변수를 이용하여 선언되어야 한다.<br/>

	// delegate 반환_형식 대리자_이름<T>( 매개변수_목록 );
	delegate int MyCompare<T>(T a, T b);

와 같이 선언할 수 있다.<br/>

그리고 대리자는 하나의 메소드가 아닌 여러 개의 메소드를 동시에 참조할 수 있다.<br/>
여러 메소드를 참조하기 위해서는 += 연산을 통해 메소드를 이어붙이면 된다.<br/>
아니면 Delegate.Combine 메소드를 이용해 이어붙일 수 있다.<br/>
이렇게 이어 붙인 것을 대리자 체인이라 한다.<br/>

대리자 체인에서 중간에 제거하고 싶은 메소드가 있다면 -= 연산이나,<br/>
Delegate.Remove() 메소드를 이용하는 방법도 있다.<br/>

대리자에 반환이 존재하는 경우 맨 뒤에 등록된 메소드 값을 반환한다.<br/>


## 익명 메소드
익명 메소드(Anonymous Method)는 이름이 없는 메소드를 의미한다.<br/>
익명 메소드는 참조할 메소드를 대리자에 넘겨야 할 일이 있고, 해당 메소드가 두 번 다시 사용할 일이 없다고 판단될때 유용하다.<br/>

익명 메소드는 delegate 키워드를 이용해 선언할 수 있다.<br/>

	대리자 인스턴스 = delegate ( 매개변수_목록 ) 
	    {

	        // 실행 하고자 하는 코드
	    };

형식은 위와 같다.<br/>


## 이벤트
어떤 일이 생겼을 때 이를 알려주는 객체가 필요한 경우가 있다.<br/>
이런 객체를 만들 때 사용하는 것이 이벤트(Event)이다.<br/>

사용 방법은 다음과 같다.<br/>
  1. 대리자를 선언한다. 해당 대리자는 클래스 내부에 있어도 외부에 있어도 상관없다.
  2. 클래스 내에 선언한 대리자의 인스턴스를 event 한정자로 수식해서 선언한다.
  3. 이벤트 핸들러를 작성한다. 대리자 형식에 일치하는 메소드면 된다.
  4. 클래스의 인스턴스를 생성하고 이 객체의 이벤트에 3에서 작성한 이벤트 핸들러를 등록하면 된다.
  5. 이벤트가 발생하면 이벤트 핸들러가 호출된다.


이벤트는 대리자와 달리 외부에서 직접 사용할 수 없다.<br/>
반면 대리자는 외부에서도 사용이 가능하다.<br/>
이벤트의 경우 내부에서 상태 변화를 감지해 다음 객체의 행동을 설정할 때 선언하는 것이 유용하다.<br/>
만약 외부에서 감지된걸 인지한다면 허위로 상태 감지를 일으켜 코드의 안정성이 매우 떨어질 수 있다.<br/>